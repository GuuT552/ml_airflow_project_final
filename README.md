# üß† ML-–ø–∞–π–ø–ª–∞–π–Ω —Å Apache Airflow: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞–∫–∞ –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ Breast Cancer Wisconsin Diagnostic.  
–¶–µ–ª—å ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è:
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ,
- –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å Logistic Regression,
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–º–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–¥–µ–ª—å) –≤ –æ–±–ª–∞—á–Ω–æ–µ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ,
- —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Apache Airflow.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ dags/                # DAG-—Ñ–∞–π–ª –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ pipeline_dag.py
‚îú‚îÄ‚îÄ etl/                 # –°–∫—Ä–∏–ø—Ç—ã ETL –∏ ML
‚îÇ   ‚îú‚îÄ‚îÄ load_data.py
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py
‚îÇ   ‚îú‚îÄ‚îÄ evaluate_model.py
‚îÇ   ‚îî‚îÄ‚îÄ save_results.py
‚îú‚îÄ‚îÄ results/             # –ú–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ logs/                # –õ–æ–≥–∏ Airflow
‚îú‚îÄ‚îÄ images/              # –°–∫—Ä–∏–Ω—à–æ—Ç DAG
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ config.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üß† ML-–∑–∞–¥–∞—á–∞
–ó–∞–¥–∞—á–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–ø—É—Ö–æ–ª—å –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π (`M`) –∏–ª–∏ –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π (`B`), –∏—Å–ø–æ–ª—å–∑—É—è 30 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –∏–∑ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```mermaid
graph TD
    A[Start DAG] --> B[–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö]
    B --> C[–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö]
    C --> D[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏]
    D --> E[–û—Ü–µ–Ω–∫–∞ –º–µ—Ç—Ä–∏–∫]
    E --> F[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤]
    F --> G[–í—ã–≥—Ä—É–∑–∫–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ]
    G --> H[End]
```

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –ö–∞–∂–¥—ã–π —à–∞–≥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –º–æ–¥—É–ª—å –≤ `etl/` –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –≤ Airflow —á–µ—Ä–µ–∑ `PythonOperator`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `joblib` –∏ `pickle` –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤
- –í—Å–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/`
- –í–æ–∑–º–æ–∂–Ω–∞ –∑–∞–º–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –æ–±–ª–∞—á–Ω–æ–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–¥–µ–ª–∏ (—á–µ—Ä–µ–∑ `config.yaml` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)

---

## üìà –û–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–æ–≤ –ø–∞–π–ø–ª–∞–π–Ω–∞

1. **load_data.py** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ CSV-—Ñ–∞–π–ª–∞, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
2. **preprocess.py** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–µ–≥–æ, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. **train_model.py** ‚Äî –æ–±—É—á–µ–Ω–∏–µ `LogisticRegression` —Å `max_iter=1000`
4. **evaluate_model.py** ‚Äî —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫: Accuracy, Precision, Recall, F1
5. **save_results.py** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ `.pkl` –∏ –º–µ—Ç—Ä–∏–∫ `.json`
6. **pipeline_dag.py** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–º —á–µ—Ä–µ–∑ Airflow

---

## üöÄ –ó–∞–ø—É—Å–∫ DAG –≤ Airflow

1. –ó–∞–ø—É—Å–∫ Airflow:
```bash
docker-compose up
```

2. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ: http://localhost:8080  
   –õ–æ–≥–∏–Ω: `admin`, –ü–∞—Ä–æ–ª—å: `admin`

3. –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ CLI:
```bash
airflow tasks test ml_pipeline_breast_cancer load_data 2024-01-01
```

---

## ‚òÅÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

–í –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–ø–∫—É `results/`.  
–ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `save_to_local_storage()` –Ω–∞ –≤—ã–≥—Ä—É–∑–∫—É –≤:
- Google Drive API (—á–µ—Ä–µ–∑ `pydrive` –∏ `credentials.json`)
- Amazon S3 (—á–µ—Ä–µ–∑ `boto3`)
- Dropbox API (—á–µ—Ä–µ–∑ `dropbox-sdk`)

–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –º–µ—Ç—Ä–∏–∫:
```json
{
  "accuracy": 0.96,
  "precision": 0.97,
  "recall": 0.95,
  "f1_score": 0.96
}
```

---

## üõ°Ô∏è –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–∞–∑–æ–≤ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

| –í–æ–∑–º–æ–∂–Ω—ã–π —Å–±–æ–π | –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ —Ä–µ—à–µ–Ω–∏–µ |
|----------------|------------------------|
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∞–π–ª–∞ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è |
| –û—à–∏–±–∫–∏ –º–æ–¥–µ–ª–∏ | try/except —Å –ª–æ–≥–∞–º–∏ |
| –ù–µ—É–¥–∞—á–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API | –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `retries` |
| –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π |
| –ü–∞–¥–µ–Ω–∏–µ Airflow-–∑–∞–¥–∞—á–∏ | `retries`, `timeout`, `catchup=False` |

–í—Å–µ —à–∞–≥–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ –ª–æ–º–∞—é—Ç –≤–µ—Å—å DAG –ø—Ä–∏ —Å–±–æ–µ.

---

## üß™ –°–∫—Ä–∏–Ω—à–æ—Ç DAG

![DAG Screenshot](images/airflow_dag.png)

---

## ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

- `requirements.txt` –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è `.env` (—á–µ—Ä–µ–∑ `os.getenv()`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `config.yaml`
- Mermaid-–¥–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## üí° –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞–∫–æ–º
- –í—ã–≥—Ä—É–∑–∫–∞ PDF-–æ—Ç—á–µ—Ç–∞ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º
- –ê–ª–µ—Ä—Ç—ã –≤ Telegram –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏ (SVM, Random Forest)

---

## üìé –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

- [UCI Breast Cancer Wisconsin (Diagnostic)](https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Diagnostic))